<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page.title | default: site.title }}</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      line-height: 1.6;
      color: #333;
      background-color: #f5f5f5;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    
    header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 2rem 0;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .header-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 2rem;
    }
    
    header h1 {
      font-size: 2rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }
    
    header p {
      opacity: 0.9;
      font-size: 1.1rem;
    }
    
    .content-wrapper {
      display: flex;
      flex: 1;
      max-width: 1400px;
      margin: 0 auto;
      width: 100%;
    }
    
    aside {
      width: 280px;
      background: white;
      padding: 2rem 0;
      box-shadow: 2px 0 10px rgba(0,0,0,0.08);
      overflow-y: auto;
      position: sticky;
      top: 0;
      height: calc(100vh - 180px);
    }
    
    .nav-section {
      margin-bottom: 1.5rem;
    }
    
    .nav-section-title {
      padding: 0.75rem 1.5rem;
      font-weight: 600;
      color: #667eea;
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .nav-section ul {
      list-style: none;
    }
    
    .nav-section a {
      display: block;
      padding: 0.75rem 1.5rem;
      color: #555;
      text-decoration: none;
      border-left: 3px solid transparent;
      transition: all 0.3s ease;
      font-size: 0.95rem;
    }
    
    .nav-section a:hover {
      background: #f5f5f5;
      color: #667eea;
      border-left-color: #667eea;
      padding-left: 2rem;
    }
    
    .nav-section a.active {
      background: #f0f0f0;
      color: #667eea;
      border-left-color: #667eea;
      padding-left: 2rem;
      font-weight: 500;
    }
    
    main {
      flex: 1;
      padding: 2rem;
      background: white;
      margin: 2rem;
      border-radius: 8px;
      box-shadow: 0 2px 20px rgba(0,0,0,0.08);
      overflow-y: auto;
      max-height: calc(100vh - 220px);
    }
    
    main h1 {
      color: #667eea;
      margin-bottom: 1.5rem;
      padding-bottom: 0.5rem;
      border-bottom: 2px solid #e0e0e0;
    }
    
    main h2 {
      color: #764ba2;
      margin-top: 2rem;
      margin-bottom: 1rem;
    }
    
    main h3 {
      color: #555;
      margin-top: 1.5rem;
      margin-bottom: 0.75rem;
    }
    
    main ul {
      margin-left: 1.5rem;
      margin-bottom: 1rem;
    }
    
    main li {
      margin-bottom: 0.5rem;
    }
    
    main a {
      color: #667eea;
      text-decoration: none;
      border-bottom: 1px solid transparent;
      transition: all 0.3s ease;
    }
    
    main a:hover {
      color: #764ba2;
      border-bottom-color: #764ba2;
    }
    
    code {
      background: #f4f4f4;
      padding: 0.2rem 0.4rem;
      border-radius: 3px;
      font-family: "Courier New", monospace;
      font-size: 0.9em;
    }
    
    pre {
      background: #f4f4f4;
      padding: 1rem;
      border-radius: 5px;
      overflow-x: auto;
      margin: 1rem 0;
    }
    
    pre code {
      background: none;
      padding: 0;
    }
    
    .mermaid {
      background: white;
      padding: 1rem;
      border-radius: 5px;
      margin: 1rem 0;
      text-align: center;
    }
    
    footer {
      background: #333;
      color: white;
      text-align: center;
      padding: 1.5rem 0;
      margin-top: auto;
    }
    
    footer p {
      opacity: 0.8;
      font-size: 0.9rem;
    }
    
    .loading {
      display: none;
      text-align: center;
      padding: 3rem;
      color: #667eea;
    }
    
    .loading.active {
      display: block;
    }
    
    @media (max-width: 768px) {
      .content-wrapper {
        flex-direction: column;
      }
      
      aside {
        width: 100%;
        height: auto;
        position: relative;
        top: auto;
        box-shadow: 0 2px 10px rgba(0,0,0,0.08);
      }
      
      main {
        margin: 1rem;
        padding: 1.5rem;
        max-height: none;
      }
      
      header h1 {
        font-size: 1.5rem;
      }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
  <script>
    mermaid.initialize({ startOnLoad: true, theme: 'default' });
  </script>
</head>
<body>
  <header>
    <div class="header-container">
      <h1>{{ site.title }}</h1>
      <p>{{ site.description }}</p>
    </div>
  </header>
  
  <div class="content-wrapper">
    <aside id="sidebar">
      <nav id="navigation"></nav>
    </aside>
    
    <main id="content">
      <div class="loading" id="loading">Carregando...</div>
      <div id="document"></div>
    </main>
  </div>
  
  <footer>
    <div>
      <p>&copy; {{ "now" | date: "%Y" }} CGI Bootcamp AI. All rights reserved. / Tous droits réservés.</p>
    </div>
  </footer>
  
  <script>
    const BASE_URL = '{{ site.baseurl }}';
    const docs = {
      epic: [
        { id: '3202', title: 'DEMO', file: '3202_DEMO.md' }
      ],
      feature: [
        { id: '3203', title: 'Enregistrer et consulter les heures de travail des employés', file: '3203_Enregistrer-et-consulter-les-heures-de-travail-des-employes.md' }
      ],
      userStories: [
        { id: '3204', title: 'Ajouter les heures travaillées pour un employé', file: '3204_Ajouter-les-heures-travaillees-pour-un-employe.md' },
        { id: '3206', title: 'Consulter le rapport hebdomadaire des heures travaillées', file: '3206_Consulter-le-rapport-hebdomadaire-des-heures-travaillees.md' }
      ],
      workshops: [
        { id: '3167', title: 'Atelier 1 - Calculatrice BASIC', file: '3167_Atelier-1-Calculatrice-BASIC.md' },
        { id: '3168', title: 'Atelier 1 - Image Mockup', file: '3168_Atelier-1-Image-Mockup.md' },
        { id: '3169', title: 'Atelier 2 - DEMO Documentation Mermaid', file: '3169_Atelier-2-DEMO-Documentation-Mermaid.md' },
        { id: '3170', title: 'Atelier 2 - DEMO MCP', file: '3170_Atelier-2-DEMO-MCP.md' },
        { id: '3171', title: 'Atelier 2 - DEMO Cas de Test et Automatisation', file: '3171_Atelier-2-DEMO-Cas-de-Test-et-Automatisation.md' },
        { id: '3172', title: 'Atelier 2 - DEMO Modernisation d\'application', file: '3172_Atelier-2-DEMO-Modernisation-d-application.md' }
      ],
      capstone: [
        { id: '3173', title: 'Capstone Project - Bootcamp AI', file: '3173_Capstone-Project-Bootcamp-AI.md' }
      ]
    };
    
    const categories = {
      epic: 'Epic',
      feature: 'Features',
      userStories: 'User Stories',
      workshops: 'Ateliers / Workshops',
      capstone: 'Capstone Project'
    };
    
    function initNavigation() {
      const nav = document.getElementById('navigation');
      nav.innerHTML = '';
      
      Object.entries(docs).forEach(([key, items]) => {
        const section = document.createElement('div');
        section.className = 'nav-section';
        
        const title = document.createElement('div');
        title.className = 'nav-section-title';
        title.textContent = categories[key];
        section.appendChild(title);
        
        const ul = document.createElement('ul');
        items.forEach(item => {
          const li = document.createElement('li');
          const a = document.createElement('a');
          a.href = '#';
          a.textContent = item.title;
          a.dataset.file = `docs/${item.file}`;
          a.onclick = (e) => {
            e.preventDefault();
            loadDocument(a.dataset.file, a);
          };
          li.appendChild(a);
          ul.appendChild(li);
        });
        
        section.appendChild(ul);
        nav.appendChild(section);
      });
      
      // Load first document by default
      const firstLink = document.querySelector('a[data-file]');
      if (firstLink) {
        loadDocument(firstLink.dataset.file, firstLink);
      }
    }
    
    function loadDocument(filePath, linkElement) {
      const loading = document.getElementById('loading');
      const content = document.getElementById('document');
      
      // Update active link
      document.querySelectorAll('a[data-file]').forEach(a => a.classList.remove('active'));
      linkElement.classList.add('active');
      
      loading.classList.add('active');
      
      fetch(`${BASE_URL}/${filePath}`)
        .then(response => {
          if (!response.ok) throw new Error('Arquivo não encontrado');
          return response.text();
        })
        .then(markdown => {
          // Simple markdown to HTML conversion
          const html = markdownToHtml(markdown);
          content.innerHTML = html;
          loading.classList.remove('active');
          
          // Reinitialize mermaid for new diagrams
          if (window.mermaid) {
            mermaid.contentLoaded();
          }
        })
        .catch(error => {
          content.innerHTML = `<p style="color: red;">Erro ao carregar o documento: ${error.message}</p>`;
          loading.classList.remove('active');
        });
    }
    
    function markdownToHtml(markdown) {
      let html = markdown
        .replace(/^### (.*?)$/gim, '<h3>$1</h3>')
        .replace(/^## (.*?)$/gim, '<h2>$1</h2>')
        .replace(/^# (.*?)$/gim, '<h1>$1</h1>')
        .replace(/\*\*(.*?)\*\*/gim, '<strong>$1</strong>')
        .replace(/\*(.*?)\*/gim, '<em>$1</em>')
        .replace(/\n\n/gim, '</p><p>')
        .replace(/^\- (.*?)$/gim, '<li>$1</li>')
        .replace(/(<li>.*?<\/li>)/s, '<ul>$1</ul>')
        .replace(/\`([^\`]+)\`/gim, '<code>$1</code>')
        .replace(/\[([^\]]+)\]\(([^)]+)\)/gim, '<a href="$2">$1</a>');
      
      return '<p>' + html + '</p>';
    }
    
    // Initialize on page load
    document.addEventListener('DOMContentLoaded', initNavigation);
  </script>
</body>
</html>
